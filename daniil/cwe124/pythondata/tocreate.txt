/home/daniil/juliet/juliet-test-suite-c/testcases/CWE124_Buffer_Underwrite/s01/output/generated/driver_CWE124_Buffer_Underwrite__char_alloca_ncpy_03_bad.c✶


// driver_CWE124_Buffer_Underwrite__char_alloca_ncpy_03_bad.c

// DO NOT include <klee/klee.h>; declare manually for compatibility.
extern void klee_make_symbolic(void *addr, unsigned long nbytes, const char *name);

void __klee_source(void *ptr, unsigned long size) {
    klee_make_symbolic(ptr, size, "buf");
}

#include "instrumented_CWE124_Buffer_Underwrite__char_alloca_ncpy_03_bad.c"

int main(void) {
    CWE124_Buffer_Underwrite__char_alloca_ncpy_03_bad();
    return 0;
}


✶/home/daniil/juliet/juliet-test-suite-c/testcases/CWE124_Buffer_Underwrite/s01/output/generated/instrumented_CWE124_Buffer_Underwrite__char_alloca_ncpy_03_bad.c✶


// instrumented_CWE124_Buffer_Underwrite__char_alloca_ncpy_03_bad.c

#include <string.h>
#include <stdio.h>
#include <alloca.h>

void __klee_source(void *ptr, unsigned long size);

void CWE124_Buffer_Underwrite__char_alloca_ncpy_03_bad()
{
    char *data;
    char *dataBuffer = (char *)alloca(100);
    memset(dataBuffer, 'A', 99);
    dataBuffer[99] = '\0';

    data = dataBuffer - 8;

    char source[100];
    memset(source, 'C', 99);
    source[99] = '\0';

    __klee_source(source, sizeof(source));

    strncpy(data, source, 99);
    data[99] = '\0';

    puts(data);
}


✶/home/daniil/juliet/juliet-test-suite-c/testcases/CWE124_Buffer_Underwrite/s01/output/generated/driver_CWE124_Buffer_Underwrite__char_alloca_cpy_01_bad.c✶


// driver_CWE124_Buffer_Underwrite__char_alloca_cpy_01_bad.c

// Manual declaration (NO #include <klee/klee.h>)
extern void klee_make_symbolic(void *addr, unsigned long nbytes, const char *name);

void __klee_source(void *ptr, unsigned long size) {
    klee_make_symbolic(ptr, size, "buf");
}

#include "instrumented_CWE124_Buffer_Underwrite__char_alloca_cpy_01_bad.c"

int main(void) {
    CWE124_Buffer_Underwrite__char_alloca_cpy_01_bad();
    return 0;
}


✶/home/daniil/juliet/juliet-test-suite-c/testcases/CWE124_Buffer_Underwrite/s01/output/generated/instrumented_CWE124_Buffer_Underwrite__char_alloca_cpy_01_bad.c✶


// instrumented_CWE124_Buffer_Underwrite__char_alloca_cpy_01_bad.c

#include <string.h>
#include <stdio.h>
#include <alloca.h>

void __klee_source(void *ptr, unsigned long size);

void CWE124_Buffer_Underwrite__char_alloca_cpy_01_bad()
{
    char *data;
    char *dataBuffer = (char *)alloca(100);
    memset(dataBuffer, 'A', 99);
    dataBuffer[99] = '\0';

    data = dataBuffer - 8;

    char source[100];
    memset(source, 'C', 99);
    source[99] = '\0';

    __klee_source(source, sizeof(source));

    strcpy(data, source);

    puts(data);
}


✶/home/daniil/juliet/juliet-test-suite-c/testcases/CWE124_Buffer_Underwrite/s01/output/generated/build.sh✶


#!/bin/bash
set -e

# No klee headers required — standard clang IR generation.

clang -emit-llvm -c -g -O0 \
    driver_CWE124_Buffer_Underwrite__char_alloca_ncpy_03_bad.c \
    -o harness_ncpy_03.bc

clang -emit-llvm -c -g -O0 \
    driver_CWE124_Buffer_Underwrite__char_alloca_cpy_01_bad.c \
    -o harness_cpy_01.bc


✶/home/daniil/juliet/juliet-test-suite-c/testcases/CWE124_Buffer_Underwrite/s01/output/generated/run_klee.sh✶


#!/bin/bash
set -e

# POSIX + uClibc only. Compatible with SNAP KLEE.
KLEE_OPTS="--posix-runtime --libc=uclibc"
```bash
klee $KLEE_OPTS harness_ncpy_03.bc
mv klee-last klee-ncpy_03

klee $KLEE_OPTS harness_cpy_01.bc
mv klee-last klee-cpy_01


